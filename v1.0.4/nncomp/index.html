<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>NN-Based Model Diagrams · MagNav.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="MagNav.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MagNav.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">MagNav.jl</a></li><li><a class="tocitem" href="../structs/">Custom Structs</a></li><li><a class="tocitem" href="../data/">Flight Path &amp; INS Data</a></li><li><a class="tocitem" href="../maps/">Magnetic Anomaly Maps</a></li><li><a class="tocitem" href="../comp/">Aeromagnetic Compensation</a></li><li class="is-active"><a class="tocitem" href>NN-Based Model Diagrams</a><ul class="internal"><li><a class="tocitem" href="#Model-1"><span>Model 1</span></a></li><li><a class="tocitem" href="#Model-2"><span>Model 2</span></a></li><li><a class="tocitem" href="#Model-3"><span>Model 3</span></a></li></ul></li><li><a class="tocitem" href="../nav/">Navigation Algorithms</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>NN-Based Model Diagrams</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>NN-Based Model Diagrams</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/MIT-AI-Accelerator/MagNav.jl/blob/master/docs/src/nncomp.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="NN-Based-Model-Diagrams"><a class="docs-heading-anchor" href="#NN-Based-Model-Diagrams">NN-Based Model Diagrams</a><a id="NN-Based-Model-Diagrams-1"></a><a class="docs-heading-anchor-permalink" href="#NN-Based-Model-Diagrams" title="Permalink"></a></h1><p>The goal of neural network-based aeromagnetic compensation is to use machine learning in order to create a nonlinear aeromagnetic compensation model. It may be possible to use additional sensors, beyond a single scalar and vector magnetometer, to improve compensation performance. Shown on this page are diagrams for each of the neural network-based aeromagnetic compensation models available within the package.</p><h2 id="Model-1"><a class="docs-heading-anchor" href="#Model-1">Model 1</a><a id="Model-1-1"></a><a class="docs-heading-anchor-permalink" href="#Model-1" title="Permalink"></a></h2><ul><li><code>:m1</code>   = standard feedforward neural network (NN)</li></ul><p><img src="../assets/m1.png" alt="m1"/></p><p>The approach taken here is to include additional data along with the typical magnetometer data. An example of possible data fields is provided in the Appendix of <a href="https://magnav.mit.edu/publications">Gnadt, 2022</a>. The idea here is that this additional data allows for greater observability of the aircraft magnetic field, and machine learning can learn the relationship between the data and aircraft field. A baseline model for this approach is to use a standard neural network to represent the compensation model in a pure data-driven approach, as shown above.</p><p>Here, the input data <span>$\boldsymbol{data}_\mathrm{aux}$</span>, also known as features, can be raw measurements and/or the Tolles-Lawson <span>$\boldsymbol{A}$</span> matrix terms. Using the Tolles-Lawson terms is a form of scientific machine learning (SciML), as these terms represent prior scientific knowledge. This can potentially reduce the amount of data required for training. Note that during training, the mean squared error (MSE) of the aeromagnetic compensation output is compared with the output target. During testing (evaluation), the aeromagnetic compensation output just prior to the &quot;loss MSE&quot; in the figure is used for navigation.</p><h2 id="Model-2"><a class="docs-heading-anchor" href="#Model-2">Model 2</a><a id="Model-2-1"></a><a class="docs-heading-anchor-permalink" href="#Model-2" title="Permalink"></a></h2><h3 id="Model-2a"><a class="docs-heading-anchor" href="#Model-2a">Model 2a</a><a id="Model-2a-1"></a><a class="docs-heading-anchor-permalink" href="#Model-2a" title="Permalink"></a></h3><ul><li><code>:m2a</code>  = NN determines Tolles-Lawson (TL) coefficients</li></ul><p><img src="../assets/m2a.png" alt="m2a"/></p><p>Model 1 can be extended into even more of a SciML approach using the physics of aeromagnetic compensation. Model 2a, shown above, more closely resembles the classical Tolles-Lawson model, now with </p><p class="math-container">\[B_\mathrm{target} = \boldsymbol{A}~\boldsymbol{\beta}_\mathrm{NN}\]</p><p>where <span>$B_\mathrm{target}$</span> is some target magnetic value, <span>$\boldsymbol{A}$</span> is the Tolles-Lawson <span>$\boldsymbol{A}$</span> matrix, and <span>$\boldsymbol{\beta}_\mathrm{NN}$</span> is a vector of varying coefficients.</p><p>Rather than directly determining some magnetic value, the output of the neural network is instead a set of varying coefficients. These are then multiplied by the Tolles-Lawson <span>$\boldsymbol{A}$</span> matrix to produce a magnetic value. The general idea here is that this model is easier to train and more interpretable, since the coefficients have meaning related to the permanent, induced, and eddy-current terms in the Tolles-Lawson model. This model uses the same input data <span>$\boldsymbol{data}_\mathrm{aux}$</span> as previously described, but also separately requires vector magnetometer measurements (<span>$B_x$</span>, <span>$B_y$</span>, <span>$B_z$</span>).</p><h3 id="Model-2b"><a class="docs-heading-anchor" href="#Model-2b">Model 2b</a><a id="Model-2b-1"></a><a class="docs-heading-anchor-permalink" href="#Model-2b" title="Permalink"></a></h3><ul><li><code>:m2b</code>  = NN determines additive correction to classical TL</li></ul><p><img src="../assets/m2b.png" alt="m2b"/></p><p>Another SciML approach that uses the physics of aeromagnetic compensation is model 2b, which is shown above. Rather than predicting the Tolles-Lawson coefficients with a neural network, the Tolles-Lawson coefficients for this approach are pre-determined, using any of the classical, modified, or map-based Tolles-Lawson models. Tolles-Lawson aeromagnetic compensation is then carried out, but large errors still remain for compensation of in-cabin magnetometers. An additive correction is then made to the Tolles-Lawson compensated value to further reduce the errors. This additive correction is the output of a neural network, similar to model 1, except now the neural network does not need to learn the Tolles-Lawson (linear) portion of the desired compensation and instead primarily learns the higher-order nonlinear portion.</p><h3 id="Model-2c"><a class="docs-heading-anchor" href="#Model-2c">Model 2c</a><a id="Model-2c-1"></a><a class="docs-heading-anchor-permalink" href="#Model-2c" title="Permalink"></a></h3><ul><li><code>:m2c</code>  = NN determines additive correction to classical TL, TL coefficients tuned as well</li></ul><p><img src="../assets/m2c.png" alt="m2c"/></p><p>An immediate extension of model 2b is model 2c, which is shown above. These models look very similar, but there is one key, subtle difference. In model 2c, the Tolles-Lawson coefficients are updated by including them as parameters during training of the neural network, rather leaving them as static values. The Tolles-Lawson coefficients are not actually part of the neural network, but the Flux machine learning library and Julia programming language provide the flexibility to backpropagate the error to the Tolles-Lawson coefficients just as with the weights of the neural network.</p><h3 id="Model-2d"><a class="docs-heading-anchor" href="#Model-2d">Model 2d</a><a id="Model-2d-1"></a><a class="docs-heading-anchor-permalink" href="#Model-2d" title="Permalink"></a></h3><ul><li><code>:m2d</code>  = NN determines additive correction to each TL coefficient</li></ul><p><img src="../assets/m2d.png" alt="m2d"/></p><p>Model 2d combines the general idea behind models 2a and 2b. An additive correction is now made to each individual (static) Tolles-Lawson coefficient. This model was developed as it was thought that making the additive correction in a higher dimensional space may improve performance further.</p><h2 id="Model-3"><a class="docs-heading-anchor" href="#Model-3">Model 3</a><a id="Model-3-1"></a><a class="docs-heading-anchor-permalink" href="#Model-3" title="Permalink"></a></h2><ul><li><code>:m3tl</code> = no NN, TL coefficients fine-tuned via SGD, without Taylor expansion for training target</li><li><code>:m3s</code>  = NN determines scalar correction to TL, using expanded TL vector terms for explainability</li><li><code>:m3v</code>  = NN determines vector correction to TL, using expanded TL vector terms for explainability</li><li><code>:m3sc</code> = <code>:m3s</code> with curriculum learning based on TL error</li><li><code>:m3vc</code> = <code>:m3v</code> with curriculum learning based on TL error</li></ul><p><img src="../assets/m3s.png" alt="m3s"/></p><p>The various forms of model 3 use a NN to determine an additive correction to the expanded vector form of Tolles-Lawson. This is the newest model under development. Shown above is the scalar correction version, and shown below is the vector correction version.</p><p><img src="../assets/m3v.png" alt="m3v"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../comp/">« Aeromagnetic Compensation</a><a class="docs-footer-nextpage" href="../nav/">Navigation Algorithms »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 17 July 2023 17:22">Monday 17 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
