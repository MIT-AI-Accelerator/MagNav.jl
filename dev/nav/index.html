<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Navigation Algorithms · MagNav.jl</title><meta name="title" content="Navigation Algorithms · MagNav.jl"/><meta property="og:title" content="Navigation Algorithms · MagNav.jl"/><meta property="twitter:title" content="Navigation Algorithms · MagNav.jl"/><meta name="description" content="Documentation for MagNav.jl."/><meta property="og:description" content="Documentation for MagNav.jl."/><meta property="twitter:description" content="Documentation for MagNav.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="MagNav.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MagNav.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../api_functions/">API: Functions</a></li><li><a class="tocitem" href="../api_structs/">API: Structs</a></li><li><a class="tocitem" href="../data/">Flight Path &amp; INS Data</a></li><li><a class="tocitem" href="../maps/">Magnetic Anomaly Maps</a></li><li><a class="tocitem" href="../comp/">Aeromagnetic Compensation</a></li><li><a class="tocitem" href="../nncomp/">NN-Based Model Diagrams</a></li><li class="is-active"><a class="tocitem" href>Navigation Algorithms</a><ul class="internal"><li><a class="tocitem" href="#MagNav-Filter-Model"><span>MagNav Filter Model</span></a></li><li><a class="tocitem" href="#Cramér–Rao-Lower-Bound"><span>Cramér–Rao Lower Bound</span></a></li><li><a class="tocitem" href="#Extended-Kalman-Filter"><span>Extended Kalman Filter</span></a></li><li><a class="tocitem" href="#Run-Filter-(with-additional-options)"><span>Run Filter (with additional options)</span></a></li></ul></li><li><span class="tocitem">Example Pluto Notebooks</span><ul><li><a class="tocitem" href="../examples/pluto_fi/">Feature Importance</a></li><li><a class="tocitem" href="../examples/pluto_linear/">Linear Models</a></li><li><a class="tocitem" href="../examples/pluto_maps/">Magnetic Anomaly Maps</a></li><li><a class="tocitem" href="../examples/pluto_model3/">Model 3</a></li><li><a class="tocitem" href="../examples/pluto_sgl/">Using SGL Data</a></li><li><a class="tocitem" href="../examples/pluto_sim/">Using Simulated Data</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Navigation Algorithms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Navigation Algorithms</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MIT-AI-Accelerator/MagNav.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MIT-AI-Accelerator/MagNav.jl/blob/master/docs/src/nav.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Navigation-Algorithms"><a class="docs-heading-anchor" href="#Navigation-Algorithms">Navigation Algorithms</a><a id="Navigation-Algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Navigation-Algorithms" title="Permalink"></a></h1><p>The following are key functions related to navigation algorithms.</p><h2 id="MagNav-Filter-Model"><a class="docs-heading-anchor" href="#MagNav-Filter-Model">MagNav Filter Model</a><a id="MagNav-Filter-Model-1"></a><a class="docs-heading-anchor-permalink" href="#MagNav-Filter-Model" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MagNav.create_model" href="#MagNav.create_model"><code>MagNav.create_model</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_model(dt = 0.1, lat1 = deg2rad(45);
             init_pos_sigma   = 3.0,
             init_alt_sigma   = 0.001,
             init_vel_sigma   = 0.01,
             init_att_sigma   = deg2rad(0.01),
             meas_var         = 3.0^2,
             VRW_sigma        = 0.000238,
             ARW_sigma        = 0.000000581,
             baro_sigma       = 1.0,
             ha_sigma         = 0.001,
             a_hat_sigma      = 0.01,
             acc_sigma        = 0.000245,
             gyro_sigma       = 0.00000000727,
             fogm_sigma       = 3.0,
             vec_sigma        = 1000.0,
             TL_sigma         = [],
             baro_tau         = 3600.0,
             acc_tau          = 3600.0,
             gyro_tau         = 3600.0,
             fogm_tau         = 600.0,
             vec_states::Bool = false,
             fogm_state::Bool = true,
             P0_TL            = [])</code></pre><p>Create a magnetic navigation filter model for use in an EKF or a MPF.</p><p><strong>Arguments:</strong></p><ul><li><code>dt</code>:             measurement time step [s]</li><li><code>lat1</code>:           initial approximate latitude [rad]</li><li><code>init_pos_sigma</code>: (optional) initial position uncertainty [m]</li><li><code>init_alt_sigma</code>: (optional) initial altitude uncertainty [m]</li><li><code>init_vel_sigma</code>: (optional) initial velocity uncertainty [m/s]</li><li><code>init_att_sigma</code>: (optional) initial attitude uncertainty [rad]</li><li><code>meas_var</code>:       (optional) measurement (white) noise variance [nT^2]</li><li><code>VRW_sigma</code>:      (optional) velocity random walk [m/s^2 /sqrt(Hz)]</li><li><code>ARW_sigma</code>:      (optional) angular  random walk [rad/s /sqrt(Hz)]</li><li><code>baro_sigma</code>:     (optional) barometer bias [m]</li><li><code>ha_sigma</code>:       (optional) barometer aiding altitude bias [m]</li><li><code>a_hat_sigma</code>:    (optional) barometer aiding vertical accel bias [m/s^2]</li><li><code>acc_sigma</code>:      (optional) accelerometer bias [m/s^2]</li><li><code>gyro_sigma</code>:     (optional) gyroscope bias [rad/s]</li><li><code>fogm_sigma</code>:     (optional) FOGM catch-all bias [nT]</li><li><code>vec_sigma</code>:      (optional) vector magnetometer noise std dev</li><li><code>TL_sigma</code>:       (optional) Tolles-Lawson coefficients estimate std dev</li><li><code>baro_tau</code>:       (optional) barometer time constant [s]</li><li><code>acc_tau</code>:        (optional) accelerometer time constant [s]</li><li><code>gyro_tau</code>:       (optional) gyroscope time constant [s]</li><li><code>fogm_tau</code>:       (optional) FOGM catch-all time constant [s]</li><li><code>vec_states</code>:     (optional) if true, include vector magnetometer states</li><li><code>fogm_state</code>:     (optional) if true, include FOGM catch-all bias state</li><li><code>P0_TL</code>:          (optional) initial Tolles-Lawson covariance matrix</li></ul><p><strong>Returns:</strong></p><ul><li><code>P0</code>: initial covariance matrix</li><li><code>Qd</code>: discrete time process/system noise matrix</li><li><code>R</code>:  measurement (white) noise variance</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-AI-Accelerator/MagNav.jl/blob/43be42613ca6fa22195f89bd63c88b4289cdf295/src/model_functions.jl#L178-L235">source</a></section></article><h3 id="MagNav-Filter-Model-Internals"><a class="docs-heading-anchor" href="#MagNav-Filter-Model-Internals">MagNav Filter Model Internals</a><a id="MagNav-Filter-Model-Internals-1"></a><a class="docs-heading-anchor-permalink" href="#MagNav-Filter-Model-Internals" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MagNav.create_P0" href="#MagNav.create_P0"><code>MagNav.create_P0</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_P0(lat1 = deg2rad(45);
          init_pos_sigma   = 3.0,
          init_alt_sigma   = 0.001,
          init_vel_sigma   = 0.01,
          init_att_sigma   = deg2rad(0.01),
          ha_sigma         = 0.001,
          a_hat_sigma      = 0.01,
          acc_sigma        = 0.000245,
          gyro_sigma       = 0.00000000727,
          fogm_sigma       = 3.0,
          vec_sigma        = 1000.0,
          vec_states::Bool = false,
          fogm_state::Bool = true,
          P0_TL            = [])</code></pre><p>Create initial covariance matrix <code>P0</code>.</p><p><strong>Arguments:</strong></p><ul><li><code>lat1</code>:           initial approximate latitude [rad]</li><li><code>init_pos_sigma</code>: (optional) initial position uncertainty [m]</li><li><code>init_alt_sigma</code>: (optional) initial altitude uncertainty [m]</li><li><code>init_vel_sigma</code>: (optional) initial velocity uncertainty [m/s]</li><li><code>init_att_sigma</code>: (optional) initial attitude uncertainty [rad]</li><li><code>ha_sigma</code>:       (optional) barometer aiding altitude bias [m]</li><li><code>a_hat_sigma</code>:    (optional) barometer aiding vertical accel bias [m/s^2]</li><li><code>acc_sigma</code>:      (optional) accelerometer bias [m/s^2]</li><li><code>gyro_sigma</code>:     (optional) gyroscope bias [rad/s]</li><li><code>fogm_sigma</code>:     (optional) FOGM catch-all bias [nT]</li><li><code>vec_sigma</code>:      (optional) vector magnetometer noise std dev</li><li><code>vec_states</code>:     (optional) if true, include vector magnetometer states</li><li><code>fogm_state</code>:     (optional) if true, include FOGM catch-all bias state</li><li><code>P0_TL</code>:          (optional) initial Tolles-Lawson covariance matrix</li></ul><p><strong>Returns:</strong></p><ul><li><code>P0</code>: initial covariance matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-AI-Accelerator/MagNav.jl/blob/43be42613ca6fa22195f89bd63c88b4289cdf295/src/model_functions.jl#L1-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MagNav.create_Qd" href="#MagNav.create_Qd"><code>MagNav.create_Qd</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_Qd(dt = 0.1;
          VRW_sigma        = 0.000238,
          ARW_sigma        = 0.000000581,
          baro_sigma       = 1.0,
          acc_sigma        = 0.000245,
          gyro_sigma       = 0.00000000727,
          fogm_sigma       = 3.0,
          vec_sigma        = 1000.0,
          TL_sigma         = [],
          baro_tau         = 3600.0,
          acc_tau          = 3600.0,
          gyro_tau         = 3600.0,
          fogm_tau         = 600.0,
          vec_states::Bool = false,
          fogm_state::Bool = true)</code></pre><p>Create the discrete time process/system noise matrix <code>Qd</code>.</p><p><strong>Arguments:</strong></p><ul><li><code>dt</code>:         measurement time step [s]</li><li><code>VRW_sigma</code>:  (optional) velocity random walk [m/s^2 /sqrt(Hz)]</li><li><code>ARW_sigma</code>:  (optional) angular  random walk [rad/s /sqrt(Hz)]</li><li><code>baro_sigma</code>: (optional) barometer bias [m]</li><li><code>acc_sigma</code>:  (optional) accelerometer bias [m/s^2]</li><li><code>gyro_sigma</code>: (optional) gyroscope bias [rad/s]</li><li><code>fogm_sigma</code>: (optional) FOGM catch-all bias [nT]</li><li><code>vec_sigma</code>:  (optional) vector magnetometer noise std dev</li><li><code>TL_sigma</code>:   (optional) Tolles-Lawson coefficients estimate std dev</li><li><code>baro_tau</code>:   (optional) barometer time constant [s]</li><li><code>acc_tau</code>:    (optional) accelerometer time constant [s]</li><li><code>gyro_tau</code>:   (optional) gyroscope time constant [s]</li><li><code>fogm_tau</code>:   (optional) FOGM catch-all time constant [s]</li><li><code>vec_states</code>: (optional) if true, include vector magnetometer states</li><li><code>fogm_state</code>: (optional) if true, include FOGM catch-all bias state</li></ul><p><strong>Returns:</strong></p><ul><li><code>Qd</code>: discrete time process/system noise matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-AI-Accelerator/MagNav.jl/blob/43be42613ca6fa22195f89bd63c88b4289cdf295/src/model_functions.jl#L89-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MagNav.get_pinson" href="#MagNav.get_pinson"><code>MagNav.get_pinson</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_pinson(nx::Int, lat, vn, ve, vd, fn, fe, fd, Cnb;
           baro_tau         = 3600.0,
           acc_tau          = 3600.0,
           gyro_tau         = 3600.0,
           fogm_tau         = 600.0,
           vec_states::Bool = false,
           fogm_state::Bool = true,
           k1=3e-2, k2=3e-4, k3=1e-6)</code></pre><p>Get the <code>nx</code> x <code>nx</code> Pinson dynamics matrix. States (errors) are:</p><table><tr><th style="text-align: left"><strong>Num</strong></th><th style="text-align: left"><strong>State</strong></th><th style="text-align: left"><strong>Units</strong></th><th style="text-align: left"><strong>Description</strong></th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">lat</td><td style="text-align: left">rad</td><td style="text-align: left">latitude</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">lon</td><td style="text-align: left">rad</td><td style="text-align: left">longitude</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">alt</td><td style="text-align: left">m</td><td style="text-align: left">altitude</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">vn</td><td style="text-align: left">m/s</td><td style="text-align: left">north velocity</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">ve</td><td style="text-align: left">m/s</td><td style="text-align: left">east  velocity</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">vd</td><td style="text-align: left">m/s</td><td style="text-align: left">down  velocity</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">tn</td><td style="text-align: left">rad</td><td style="text-align: left">north tilt (attitude)</td></tr><tr><td style="text-align: left">8</td><td style="text-align: left">te</td><td style="text-align: left">rad</td><td style="text-align: left">east  tilt (attitude)</td></tr><tr><td style="text-align: left">9</td><td style="text-align: left">td</td><td style="text-align: left">rad</td><td style="text-align: left">down  tilt (attitude)</td></tr><tr><td style="text-align: left">10</td><td style="text-align: left">ha</td><td style="text-align: left">m</td><td style="text-align: left">barometer aiding altitude</td></tr><tr><td style="text-align: left">11</td><td style="text-align: left">a_hat</td><td style="text-align: left">m/s^2</td><td style="text-align: left">barometer aiding vertical acceleration</td></tr><tr><td style="text-align: left">12</td><td style="text-align: left">ax</td><td style="text-align: left">m/s^2</td><td style="text-align: left">x accelerometer</td></tr><tr><td style="text-align: left">13</td><td style="text-align: left">ay</td><td style="text-align: left">m/s^2</td><td style="text-align: left">y accelerometer</td></tr><tr><td style="text-align: left">14</td><td style="text-align: left">az</td><td style="text-align: left">m/s^2</td><td style="text-align: left">z accelerometer</td></tr><tr><td style="text-align: left">15</td><td style="text-align: left">gx</td><td style="text-align: left">rad/s</td><td style="text-align: left">x gyroscope</td></tr><tr><td style="text-align: left">16</td><td style="text-align: left">gy</td><td style="text-align: left">rad/s</td><td style="text-align: left">y gyroscope</td></tr><tr><td style="text-align: left">17</td><td style="text-align: left">gz</td><td style="text-align: left">rad/s</td><td style="text-align: left">z gyroscope</td></tr><tr><td style="text-align: left">end</td><td style="text-align: left">S</td><td style="text-align: left">nT</td><td style="text-align: left">FOGM catch-all</td></tr></table><p><strong>Arguments:</strong></p><ul><li><code>nx</code>:         total state dimension</li><li><code>lat</code>:        latitude       [rad]</li><li><code>vn</code>:         north velocity [m/s]</li><li><code>ve</code>:         east  velocity [m/s]</li><li><code>vd</code>:         down  velocity [m/s]</li><li><code>fn</code>:         north specific force [m/s^2]</li><li><code>fe</code>:         east  specific force [m/s^2]</li><li><code>fd</code>:         down  specific force [m/s^2]</li><li><code>Cnb</code>:        direction cosine matrix (body to navigation) [-]</li><li><code>baro_tau</code>:   (optional) barometer      time constant [s]</li><li><code>acc_tau</code>:    (optional) accelerometer  time constant [s]</li><li><code>gyro_tau</code>:   (optional) gyroscope      time constant [s]</li><li><code>fogm_tau</code>:   (optional) FOGM catch-all time constant [s]</li><li><code>vec_states</code>: (optional) if true, include vector magnetometer states</li><li><code>fogm_state</code>: (optional) if true, include FOGM catch-all bias state</li><li><code>k1</code>:         (optional) barometer aiding constant [1/s]</li><li><code>k2</code>:         (optional) barometer aiding constant [1/s^2]</li><li><code>k3</code>:         (optional) barometer aiding constant [1/s^3]</li></ul><p><strong>Returns:</strong></p><ul><li><code>F</code>: <code>nx</code> x <code>nx</code> Pinson matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-AI-Accelerator/MagNav.jl/blob/43be42613ca6fa22195f89bd63c88b4289cdf295/src/model_functions.jl#L296-L351">source</a></section></article><h2 id="Cramér–Rao-Lower-Bound"><a class="docs-heading-anchor" href="#Cramér–Rao-Lower-Bound">Cramér–Rao Lower Bound</a><a id="Cramér–Rao-Lower-Bound-1"></a><a class="docs-heading-anchor-permalink" href="#Cramér–Rao-Lower-Bound" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MagNav.crlb" href="#MagNav.crlb"><code>MagNav.crlb</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">crlb(lat, lon, alt, vn, ve, vd, fn, fe, fd, Cnb, dt, itp_mapS;
     P0         = create_P0(),
     Qd         = create_Qd(),
     R          = 1.0,
     baro_tau   = 3600.0,
     acc_tau    = 3600.0,
     gyro_tau   = 3600.0,
     fogm_tau   = 600.0,
     date       = get_years(2020,185),
     core::Bool = false)</code></pre><p>Cramér–Rao lower bound (CRLB) computed with classic Kalman Filter. Equations evaluated about true trajectory.</p><p><strong>Arguments:</strong></p><ul><li><code>lat</code>:      latitude  [rad]</li><li><code>lon</code>:      longitude [rad]</li><li><code>alt</code>:      altitude  [m]</li><li><code>vn</code>:       north velocity [m/s]</li><li><code>ve</code>:       east  velocity [m/s]</li><li><code>vd</code>:       down  velocity [m/s]</li><li><code>fn</code>:       north specific force [m/s^2]</li><li><code>fe</code>:       east  specific force [m/s^2]</li><li><code>fd</code>:       down  specific force [m/s^2]</li><li><code>Cnb</code>:      direction cosine matrix (body to navigation) [-]</li><li><code>dt</code>:       measurement time step [s]</li><li><code>itp_mapS</code>: scalar map interpolation function (<code>f(lat,lon)</code> or <code>f(lat,lon,alt)</code>)</li><li><code>P0</code>:       (optional) initial covariance matrix</li><li><code>Qd</code>:       (optional) discrete time process/system noise matrix</li><li><code>R</code>:        (optional) measurement (white) noise variance</li><li><code>baro_tau</code>: (optional) barometer time constant [s]</li><li><code>acc_tau</code>:  (optional) accelerometer time constant [s]</li><li><code>gyro_tau</code>: (optional) gyroscope time constant [s]</li><li><code>fogm_tau</code>: (optional) FOGM catch-all time constant [s]</li><li><code>date</code>:     (optional) measurement date (decimal year) for IGRF [yr]</li><li><code>core</code>:     (optional) if true, include core magnetic field in measurement</li></ul><p><strong>Returns:</strong></p><ul><li><code>P</code>: non-linear covariance matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-AI-Accelerator/MagNav.jl/blob/43be42613ca6fa22195f89bd63c88b4289cdf295/src/ekf_&amp;_crlb.jl#L316-L356">source</a></section><section><div><pre><code class="language-julia hljs">crlb(traj::Traj, itp_mapS;
     P0         = create_P0(),
     Qd         = create_Qd(),
     R          = 1.0,
     baro_tau   = 3600.0,
     acc_tau    = 3600.0,
     gyro_tau   = 3600.0,
     fogm_tau   = 600.0,
     date       = get_years(2020,185),
     core::Bool = false)</code></pre><p>Cramér–Rao lower bound (CRLB) computed with classic Kalman Filter. Equations evaluated about true trajectory.</p><p><strong>Arguments:</strong></p><ul><li><code>traj</code>:     <code>Traj</code> trajectory struct</li><li><code>itp_mapS</code>: scalar map interpolation function (<code>f(lat,lon)</code> or <code>f(lat,lon,alt)</code>)</li><li><code>P0</code>:       (optional) initial covariance matrix</li><li><code>Qd</code>:       (optional) discrete time process/system noise matrix</li><li><code>R</code>:        (optional) measurement (white) noise variance</li><li><code>baro_tau</code>: (optional) barometer time constant [s]</li><li><code>acc_tau</code>:  (optional) accelerometer time constant [s]</li><li><code>gyro_tau</code>: (optional) gyroscope time constant [s]</li><li><code>fogm_tau</code>: (optional) FOGM catch-all time constant [s]</li><li><code>date</code>:     (optional) measurement date (decimal year) for IGRF [yr]</li><li><code>core</code>:     (optional) if true, include core magnetic field in measurement</li></ul><p><strong>Returns:</strong></p><ul><li><code>P</code>: non-linear covariance matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-AI-Accelerator/MagNav.jl/blob/43be42613ca6fa22195f89bd63c88b4289cdf295/src/ekf_&amp;_crlb.jl#L398-L428">source</a></section></article><h2 id="Extended-Kalman-Filter"><a class="docs-heading-anchor" href="#Extended-Kalman-Filter">Extended Kalman Filter</a><a id="Extended-Kalman-Filter-1"></a><a class="docs-heading-anchor-permalink" href="#Extended-Kalman-Filter" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MagNav.ekf" href="#MagNav.ekf"><code>MagNav.ekf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ekf(lat, lon, alt, vn, ve, vd, fn, fe, fd, Cnb, meas, dt, itp_mapS;
    P0         = create_P0(),
    Qd         = create_Qd(),
    R          = 1.0,
    baro_tau   = 3600.0,
    acc_tau    = 3600.0,
    gyro_tau   = 3600.0,
    fogm_tau   = 600.0,
    date       = get_years(2020,185),
    core::Bool = false,
    der_mapS   = nothing,
    map_alt    = 0)</code></pre><p>Extended Kalman filter (EKF) for airborne magnetic anomaly navigation.</p><p><strong>Arguments:</strong></p><ul><li><code>lat</code>:      latitude  [rad]</li><li><code>lon</code>:      longitude [rad]</li><li><code>alt</code>:      altitude  [m]</li><li><code>vn</code>:       north velocity [m/s]</li><li><code>ve</code>:       east  velocity [m/s]</li><li><code>vd</code>:       down  velocity [m/s]</li><li><code>fn</code>:       north specific force [m/s^2]</li><li><code>fe</code>:       east  specific force [m/s^2]</li><li><code>fd</code>:       down  specific force [m/s^2]</li><li><code>Cnb</code>:      direction cosine matrix (body to navigation) [-]</li><li><code>meas</code>:     scalar magnetometer measurement [nT]</li><li><code>dt</code>:       measurement time step [s]</li><li><code>itp_mapS</code>: scalar map interpolation function (<code>f(lat,lon)</code> or <code>f(lat,lon,alt)</code>)</li><li><code>P0</code>:       (optional) initial covariance matrix</li><li><code>Qd</code>:       (optional) discrete time process/system noise matrix</li><li><code>R</code>:        (optional) measurement (white) noise variance</li><li><code>baro_tau</code>: (optional) barometer time constant [s]</li><li><code>acc_tau</code>:  (optional) accelerometer time constant [s]</li><li><code>gyro_tau</code>: (optional) gyroscope time constant [s]</li><li><code>fogm_tau</code>: (optional) FOGM catch-all time constant [s]</li><li><code>date</code>:     (optional) measurement date (decimal year) for IGRF [yr]</li><li><code>core</code>:     (optional) if true, include core magnetic field in measurement</li><li><code>der_mapS</code>: (optional) scalar map vertical derivative map interpolation function (<code>f(lat,lon)</code> or (<code>f(lat,lon,alt)</code>)</li><li><code>map_alt</code>:  (optional) map altitude [m]</li></ul><p><strong>Returns:</strong></p><ul><li><code>filt_res</code>: <code>FILTres</code> filter results struct</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-AI-Accelerator/MagNav.jl/blob/43be42613ca6fa22195f89bd63c88b4289cdf295/src/ekf_&amp;_crlb.jl#L1-L45">source</a></section><section><div><pre><code class="language-julia hljs">ekf(ins::INS, meas, itp_mapS;
    P0         = create_P0(),
    Qd         = create_Qd(),
    R          = 1.0,
    baro_tau   = 3600.0,
    acc_tau    = 3600.0,
    gyro_tau   = 3600.0,
    fogm_tau   = 600.0,
    date       = get_years(2020,185),
    core::Bool = false,
    der_mapS   = map_itp(zeros(2,2),[-pi,pi],[-pi/2,pi/2]),
    map_alt    = 0)</code></pre><p>Extended Kalman filter (EKF) for airborne magnetic anomaly navigation.</p><p><strong>Arguments:</strong></p><ul><li><code>ins</code>:      <code>INS</code> inertial navigation system struct</li><li><code>meas</code>:     scalar magnetometer measurement [nT]</li><li><code>itp_mapS</code>: scalar map interpolation function (<code>f(lat,lon)</code> or <code>f(lat,lon,alt)</code>)</li><li><code>P0</code>:       (optional) initial covariance matrix</li><li><code>Qd</code>:       (optional) discrete time process/system noise matrix</li><li><code>R</code>:        (optional) measurement (white) noise variance</li><li><code>baro_tau</code>: (optional) barometer time constant [s]</li><li><code>acc_tau</code>:  (optional) accelerometer time constant [s]</li><li><code>gyro_tau</code>: (optional) gyroscope time constant [s]</li><li><code>fogm_tau</code>: (optional) FOGM catch-all time constant [s]</li><li><code>date</code>:     (optional) measurement date (decimal year) for IGRF [yr]</li><li><code>core</code>:     (optional) if true, include core magnetic field in measurement</li><li><code>der_mapS</code>: (optional) scalar map vertical derivative map interpolation function (<code>f(lat,lon)</code> or (<code>f(lat,lon,alt)</code>)</li><li><code>map_alt</code>:  (optional) map altitude [m]</li></ul><p><strong>Returns:</strong></p><ul><li><code>filt_res</code>: <code>FILTres</code> filter results struct</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-AI-Accelerator/MagNav.jl/blob/43be42613ca6fa22195f89bd63c88b4289cdf295/src/ekf_&amp;_crlb.jl#L136-L170">source</a></section></article><h2 id="Run-Filter-(with-additional-options)"><a class="docs-heading-anchor" href="#Run-Filter-(with-additional-options)">Run Filter (with additional options)</a><a id="Run-Filter-(with-additional-options)-1"></a><a class="docs-heading-anchor-permalink" href="#Run-Filter-(with-additional-options)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MagNav.run_filt" href="#MagNav.run_filt"><code>MagNav.run_filt</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_filt(traj::Traj, ins::INS, meas, itp_mapS, filt_type::Symbol = :ekf;
         P0             = create_P0(),
         Qd             = create_Qd(),
         R              = 1.0,
         num_part       = 1000,
         thresh         = 0.8,
         baro_tau       = 3600.0,
         acc_tau        = 3600.0,
         gyro_tau       = 3600.0,
         fogm_tau       = 600.0,
         date           = get_years(2020,185),
         core::Bool     = false,
         map_alt        = 0,
         x_nn           = nothing,
         m              = nothing,
         y_norms        = nothing,
         terms          = [:permanent,:induced,:eddy,:bias],
         flux::MagV     = MagV([0.0],[0.0],[0.0],[0.0]),
         x0_TL          = ones(eltype(P0),19),
         extract::Bool  = true,
         run_crlb::Bool = true)</code></pre><p>Run navigation filter and optionally compute Cramér–Rao lower bound (CRLB).</p><p><strong>Arguments:</strong></p><ul><li><code>traj</code>:      <code>Traj</code> trajectory struct</li><li><code>ins</code>:       <code>INS</code> inertial navigation system struct</li><li><code>meas</code>:      scalar magnetometer measurement [nT]</li><li><code>itp_mapS</code>:  scalar map interpolation function (<code>f(lat,lon)</code> or <code>f(lat,lon,alt)</code>)</li><li><code>filt_type</code>: (optional) filter type {<code>:ekf</code>,<code>:mpf</code>}</li><li><code>P0</code>:        (optional) initial covariance matrix</li><li><code>Qd</code>:        (optional) discrete time process/system noise matrix</li><li><code>R</code>:         (optional) measurement (white) noise variance</li><li><code>num_part</code>:  (optional) number of particles, only used for <code>filt_type = :mpf</code></li><li><code>thresh</code>:    (optional) resampling threshold fraction {0:1}, only used for <code>filt_type = :mpf</code></li><li><code>baro_tau</code>:  (optional) barometer time constant [s]</li><li><code>acc_tau</code>:   (optional) accelerometer time constant [s]</li><li><code>gyro_tau</code>:  (optional) gyroscope time constant [s]</li><li><code>fogm_tau</code>:  (optional) FOGM catch-all time constant [s]</li><li><code>date</code>:      (optional) measurement date (decimal year) for IGRF [yr]</li><li><code>core</code>:      (optional) if true, include core magnetic field in measurement</li><li><code>map_alt</code>:   (optional) map altitude [m]</li><li><code>x_nn</code>:      (optional) <code>N</code> x <code>Nf</code> data matrix for neural network (<code>Nf</code> is number of features)</li><li><code>m</code>:         (optional) neural network model</li><li><code>y_norms</code>:   (optional) tuple of <code>y</code> normalizations, i.e., <code>(y_bias,y_scale)</code></li><li><code>terms</code>:     (optional) Tolles-Lawson terms to use {<code>:permanent</code>,<code>:induced</code>,<code>:eddy</code>,<code>:bias</code>}</li><li><code>flux</code>:      (optional) <code>MagV</code> vector magnetometer measurement struct</li><li><code>x0_TL</code>:     (optional) initial Tolles-Lawson coefficient states</li><li><code>extract</code>:   (optional) if true, extract output structs</li><li><code>run_crlb</code>:  (optional) if true, compute the Cramér–Rao lower bound (CRLB)</li></ul><p><strong>Returns:</strong></p><ul><li>if <code>extract = true</code>  &amp; <code>run_crlb = true</code><ul><li><code>crlb_out</code>: <code>CRLBout</code> Cramér–Rao lower bound extracted output struct</li><li><code>ins_out</code>:  <code>INSout</code>  inertial navigation system extracted output struct</li><li><code>filt_out</code>: <code>FILTout</code> filter extracted output struct</li></ul></li><li>if <code>extract = true</code>  &amp; <code>run_crlb = false</code><ul><li><code>filt_out</code>: <code>FILTout</code> filter extracted output struct</li></ul></li><li>if <code>extract = false</code> &amp; <code>run_crlb = true</code><ul><li><code>filt_res</code>: <code>FILTres</code> filter results struct</li><li><code>crlb_P</code>:   Cramér–Rao lower bound non-linear covariance matrix</li></ul></li><li>if <code>extract = false</code> &amp; <code>run_crlb = false</code><ul><li><code>filt_res</code>: <code>FILTres</code> filter results struct</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-AI-Accelerator/MagNav.jl/blob/43be42613ca6fa22195f89bd63c88b4289cdf295/src/eval_filt.jl#L1-L65">source</a></section><section><div><pre><code class="language-julia hljs">run_filt(traj::Traj, ins::INS, meas, itp_mapS,
         filt_type::Vector{Symbol}; ...)</code></pre><p>Run multiple filter models and print results (nothing returned).</p><p><strong>Arguments:</strong></p><ul><li><code>filt_type</code>: multiple filter types, e.g., [<code>:ekf</code>,<code>:ekf_online_nn</code>]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-AI-Accelerator/MagNav.jl/blob/43be42613ca6fa22195f89bd63c88b4289cdf295/src/eval_filt.jl#L170-L178">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../nncomp/">« NN-Based Model Diagrams</a><a class="docs-footer-nextpage" href="../examples/pluto_fi/">Feature Importance »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Wednesday 30 April 2025 04:19">Wednesday 30 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
